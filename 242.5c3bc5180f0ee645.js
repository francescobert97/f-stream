"use strict";(self.webpackChunkstream=self.webpackChunkstream||[]).push([[242],{1242:(k,d,n)=>{n.r(d),n.d(d,{PlayerModule:()=>U});var l=n(177),v=n(4367),f=n(8326),c=n(9632),r=n(98),u=n(4916),t=n(4438),p=n(7699),y=n(1367),m=n(7668);const g=e=>({label:e,classes:" p-4"}),F=e=>({label:e,classes:"p-4"});let b=(()=>{class e{constructor(){this.movie=u.Y,this.userTools={rating:{isSwitched:!1,label:"add"},favourite:{isSwitched:!1,label:"add"}}}ngOnInit(){this.user.favouriteFilms.find(o=>o.id===this.movie.id)&&(this.userTools.favourite={label:"remove",isSwitched:!0})}addLikeToMovie(s){"rating"===s?this.userTools.rating.isSwitched?(this.movie.likes-=1,this.userTools.rating.label="add",this.userTools.rating.isSwitched=!1):(this.movie.likes+=1,this.userTools.rating.label="remove",this.userTools.rating.isSwitched=!0):this.userTools.favourite.isSwitched?(this.userTools.favourite={label:"add",isSwitched:!1},this.setFavouriteFilms("delete")):(this.userTools.favourite={label:"remove",isSwitched:!0},this.setFavouriteFilms("set"))}setFavouriteFilms(s){const o=new Map(this.user.favouriteFilms.map(i=>[i.id,{...i}]));"set"===s?o[s](this.movie.id,this.movie):o[s](this.movie.id),this.user.favouriteFilms=Array.from(o.values())}static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275cmp=t.VBU({type:e,selectors:[["app-user-interaction-tools"]],inputs:{movie:"movie",user:"user"},decls:3,vars:6,consts:[[1,"offset-1","d-flex","gap-3"],[3,"callFnFromOutside","customDataButton"]],template:function(o,i){1&o&&(t.j41(0,"div",0)(1,"app-custom-button",1),t.bIt("callFnFromOutside",function(){return i.addLikeToMovie("favourite")}),t.k0s(),t.j41(2,"app-custom-button",1),t.bIt("callFnFromOutside",function(){return i.addLikeToMovie("rating")}),t.k0s()()),2&o&&(t.R7$(),t.Y8G("customDataButton",t.eq3(2,g,i.userTools.favourite.label)),t.R7$(),t.Y8G("customDataButton",t.eq3(4,F,i.userTools.rating.label)))},dependencies:[m.z],encapsulation:2})}}return e})();const C=()=>({label:"Close",classes:"position-absolute close-video-player z-index-moreover"});let P=(()=>{class e{constructor(s){this.titlesStream=s,this.movie=u.Y,this.closeVideoplayer=new t.bkB}ngOnInit(){const s=new Date;this.movie.lastWatch=`${s.getFullYear()}/${s.getMonth()+1}/${s.getDay()<10?"0"+s.getDay():s.getDay()}`,this.titlesStream.updateFilm(this.movie)}closePlayer(){this.closeVideoplayer.emit(null)}static{this.\u0275fac=function(o){return new(o||e)(t.rXU(p.h))}}static{this.\u0275cmp=t.VBU({type:e,selectors:[["app-video-player"]],inputs:{movie:"movie"},outputs:{closeVideoplayer:"closeVideoplayer"},decls:3,vars:3,consts:[["id","player",1,"z-index-moreover","offset-sm-2","col-sm-8"],[3,"callFnFromOutside","customDataButton"],["controls","",1,"active-link",3,"src"]],template:function(o,i){1&o&&(t.j41(0,"div",0)(1,"app-custom-button",1),t.bIt("callFnFromOutside",function(){return i.closePlayer()}),t.k0s(),t.nrm(2,"video",2),t.k0s()),2&o&&(t.R7$(),t.Y8G("customDataButton",t.lJ4(2,C)),t.R7$(),t.FS9("src",i.movie.urlStream,t.B4B))},dependencies:[m.z],styles:["#player[_ngcontent-%COMP%]{position:fixed;top:15%;left:2%}#player[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{width:100%}"]})}}return e})();const T=e=>({label:"Back",classes:"",link:e}),S=()=>({label:"PLAY",classes:"position-absolute play-btn gradient-bg p-4"});function M(e,D){if(1&e){const s=t.RV6();t.j41(0,"div",8)(1,"app-video-player",9),t.bIt("closeVideoplayer",function(){t.eBV(s);const i=t.XpG();return t.Njj(i.showPlayer=!i.showPlayer)}),t.k0s()()}if(2&e){const s=t.XpG();t.R7$(),t.Y8G("movie",s.movie)}}let h=(()=>{class e{constructor(s,o,i){this.route=s,this.titlesStream=o,this.loginService=i,this.showPlayer=!1,this.movie=u.Y}ngOnInit(){const s=(0,r.zM)("currentMovieWatched");s?this.movie=s:this.filmSubs=this.route.queryParams.subscribe(o=>this.movie=this.titlesStream.getFilm({id:Number(o.id),genere:o.genere})),this.loginService.currentUser$.subscribe(o=>this.user=o)}pushMovieUpdates(){this.loginService.currentUser$.next(this.user),(0,r.Nq)("currentUser",this.user),this.titlesStream.updateFilm(this.movie)}cleanLocalStorage(){(0,r.n5)("currentMovieWatched")}ngOnDestroy(){this.loginService.currentUser$.next(this.user),(0,r.Nq)("currentUser",this.user),this.titlesStream.updateFilm(this.movie),this.cleanLocalStorage(),this.filmSubs&&this.filmSubs.unsubscribe()}static{this.\u0275fac=function(o){return new(o||e)(t.rXU(c.nX),t.rXU(p.h),t.rXU(y.H))}}static{this.\u0275cmp=t.VBU({type:e,selectors:[["app-player-container"]],hostBindings:function(o,i){1&o&&t.bIt("beforeunload",function($){return i.pushMovieUpdates($)},!1,t.tSv)},decls:12,vars:12,consts:[[1,"w-100","p-3","movie-information"],[3,"callFnFromOutside","customDataButton"],[1,"col-sm-6","offset-md-2","p-4","col-12"],[1,"col-12","bg-light","text-dark","col-sm-10","offset-md-1","active-link","overflow-hidden","position-relative"],["alt","img copertina",2,"height","clamp(400px, 500px, 600px )","width","100%",3,"src"],[1,"col-sm-2","offset-md-2","p-5"],[3,"movie","user"],["id","shadow-screen","class","z-index-strong row",4,"ngIf"],["id","shadow-screen",1,"z-index-strong","row"],[3,"closeVideoplayer","movie"]],template:function(o,i){1&o&&(t.j41(0,"div",0)(1,"app-custom-button",1),t.bIt("callFnFromOutside",function(){return i.cleanLocalStorage()}),t.k0s(),t.j41(2,"h1",2),t.EFF(3),t.nI1(4,"uppercase"),t.k0s(),t.j41(5,"div",3),t.nrm(6,"img",4),t.j41(7,"app-custom-button",1),t.bIt("callFnFromOutside",function(){return i.showPlayer=!i.showPlayer}),t.k0s()(),t.j41(8,"p",5),t.EFF(9,"Lorem ipsum dolor sit amet consectetur adipisicing elit. Ipsam soluta eum voluptas ad placeat! Perspiciatis, incidunt id! A, similique et animi, fuga molestiae molestias fugiat totam sed provident in natus."),t.k0s(),t.nrm(10,"app-user-interaction-tools",6),t.k0s(),t.DNE(11,M,2,1,"div",7)),2&o&&(t.R7$(),t.Y8G("customDataButton",t.eq3(9,T,"/home/"+i.movie.genere)),t.R7$(2),t.JRh(t.bMT(4,7,i.movie.titolo)),t.R7$(3),t.FS9("src",i.movie.urlCopertina,t.B4B),t.R7$(),t.Y8G("customDataButton",t.lJ4(11,S)),t.R7$(3),t.Y8G("movie",i.movie)("user",i.user),t.R7$(),t.Y8G("ngIf",i.showPlayer))},dependencies:[l.bT,m.z,b,P,l.Pc],styles:[".movie-information[_ngcontent-%COMP%]{text-shadow:var(--text-shadow)}.movie-information[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{letter-spacing:2px}#shadow-screen[_ngcontent-%COMP%]{position:fixed;width:100%;height:100%;left:0;top:0;background:#00000078}"]})}}return e})(),w=(()=>{class e{constructor(){}canActivate(){return!!(0,r.zM)("currentMovieWatched")}static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275prov=t.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();const O=[{path:"",component:h,children:[{path:":movieId",component:h}],canActivate:[n(5227).q,w]}];let B=(()=>{class e{static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275mod=t.$C({type:e})}static{this.\u0275inj=t.G2t({imports:[c.iI.forChild(O),c.iI]})}}return e})(),U=(()=>{class e{static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275mod=t.$C({type:e})}static{this.\u0275inj=t.G2t({imports:[l.MD,v.j,f.YN,B]})}}return e})()}}]);